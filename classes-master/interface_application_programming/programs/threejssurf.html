<html>
<head>
<title>three.js surface test</title>
<script src="three.min.js"></script>
</head>
<body>
<div id="div" style="position:absolute;top:0%;height:100%;left:0%;width:100%;text-align:center;">
</div>
<script type="text/javascript">
//
// threejssurf.html
// Neil Gershenfeld 2/3/17
// demonstrates drawing three.js surfaces by animating sin(k*x)/k*x
//
var div = document.getElementById("div")
var height = div.clientHeight
var width = height
var npts = 100
var nloop = 100
var loop = 1
var step = 1
var scene = new THREE.Scene()
var camera = new THREE.PerspectiveCamera(45,
   window.innerWidth/window.innerHeight,0.1,1000)
camera.position.set(0,-2.75,1.5);
camera.rotation.x = 65*(Math.PI/180)
var geometry = new THREE.PlaneGeometry(1,1,npts,npts)
for (var y = 0; y <= npts; ++y)
   for (var x = 0; x <= npts; ++x) {
      geometry.vertices[x*(npts+1)+y].x = 2*(x-npts/2)/npts
      geometry.vertices[x*(npts+1)+y].y = 2*(y-npts/2)/npts
      }
var material = new THREE.MeshPhongMaterial({color:0xc5b358})
var mesh = new THREE.Mesh(geometry,material)
scene.add(mesh)
var ambientLight = new THREE.AmbientLight(0xffffff)
scene.add(ambientLight)
light = new THREE.SpotLight(0xffffff,0.3)
light.position.set(0,-10,1)
scene.add(light)
var renderer = new THREE.WebGLRenderer({antialias:true})
renderer.setClearColor(new THREE.Color(0xffffff))
renderer.setSize(width,height)
document.body.appendChild(renderer.domElement)
animate()
function animate() {
   var r,z
   for (var y = 0; y <= npts; ++y) {
      for (var x = 0; x <= npts; ++x) {
         r = 30*Math.sqrt((0.5+y-npts/2)*(0.5+y-npts/2)+
            (0.5+x-npts/2)*(0.5+x-npts/2))/(nloop*npts/2)
         z = (1+Math.sin(loop*r)/(loop*r))/2
         mesh.geometry.vertices[x*(npts+1)+y].z = z
         }
      }
   loop += step
   if ((loop == 1) || (loop == nloop))
      step = -step
   mesh.rotation.z += 1/1000
   mesh.geometry.computeFaceNormals()
   mesh.geometry.computeVertexNormals()
   mesh.geometry.verticesNeedUpdate = true
   renderer.render(scene,camera);
   requestAnimationFrame(animate)
	}
</script>
</body>
</html>
